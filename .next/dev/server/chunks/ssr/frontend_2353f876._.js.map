{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/components/tables/ContactsTable.tsx"],"sourcesContent":["\r\n\"use client\";\r\nimport { useEffect, useState } from 'react';\r\n\r\n\r\n\r\n\r\nexport default function ContactsTable({ search = \"\", refresh = 0, adminView = false }: { search?: string, refresh?: number, adminView?: boolean }) {\r\n  // All hooks at the top\r\n  const [contacts, setContacts] = useState<any[]>([]);\r\n  const [accounts, setAccounts] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selected, setSelected] = useState<string[]>([]);\r\n  const [deleting, setDeleting] = useState(false);\r\n  const [hydrated, setHydrated] = useState(false);\r\n  const [isMobile, setIsMobile] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    // Fetch contacts\r\n    fetch(adminView ? '/api/contacts?admin=1' : '/api/contacts')\r\n      .then(async res => {\r\n        try {\r\n          const data = await res.json();\r\n          setContacts(Array.isArray(data) ? data : []);\r\n        } catch (e) {\r\n          setContacts([]);\r\n        }\r\n        setLoading(false);\r\n      });\r\n    // Fetch accounts for mapping\r\n    fetch('/api/accounts')\r\n      .then(res => res.json())\r\n      .then(data => setAccounts(Array.isArray(data) ? data : []))\r\n      .catch(() => setAccounts([]));\r\n  }, [refresh, adminView]);\r\n\r\n  useEffect(() => {\r\n    setHydrated(true);\r\n    function handleResize() {\r\n      setIsMobile(window.innerWidth <= 700);\r\n    }\r\n    handleResize();\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  const filtered = search\r\n    ? contacts.filter((c: any) =>\r\n        (c.name || '').toLowerCase().includes(search.toLowerCase()) ||\r\n        (c.email || '').toLowerCase().includes(search.toLowerCase()) ||\r\n        (c.phone || '').toLowerCase().includes(search.toLowerCase())\r\n      )\r\n    : contacts;\r\n\r\n  const showCards = hydrated && isMobile;\r\n\r\n  if (loading) return <div style={{ padding: 32, textAlign: 'center', color: '#888' }}>Loading contacts...</div>;\r\n\r\n  return (\r\n    <div className=\"contacts-table-responsive\">\r\n      {adminView && (\r\n        <div className=\"mb-6 flex items-center gap-4 bg-gray-50 rounded-xl px-6 py-4 shadow-sm\" style={{ maxWidth: 600 }}>\r\n          <span className=\"font-bold text-lg text-gray-700\">Delete Selected ({selected.length})</span>\r\n          <button\r\n            className=\"ml-8 mr-4 pl-4 px-6 py-2 rounded-lg bg-red-600 text-white font-bold shadow hover:bg-red-700 transition disabled:opacity-50 text-lg\"\r\n            style={{ background: '#e53935', color: '#fff', fontWeight: 700, fontSize: 18, minWidth: 100 , marginLeft: 10, marginBottom: 2}}\r\n            disabled={selected.length === 0 || deleting}\r\n            onClick={async () => {\r\n              if (!window.confirm(`Delete ${selected.length} selected contacts?`)) return;\r\n              setDeleting(true);\r\n              try {\r\n                const res = await fetch('/api/contacts/bulk', {\r\n                  method: 'DELETE',\r\n                  headers: { 'Content-Type': 'application/json' },\r\n                  body: JSON.stringify({ ids: selected }),\r\n                });\r\n                if (res.ok) {\r\n                  setContacts(contacts.filter(c => !selected.includes(c.id)));\r\n                  setSelected([]);\r\n                } else {\r\n                  alert('Bulk delete failed');\r\n                }\r\n              } finally {\r\n                setDeleting(false);\r\n              }\r\n            }}\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      )}\r\n      {showCards ? (\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: 14 }}>\r\n          {filtered.length === 0 ? (\r\n            <div style={{ padding: 24, textAlign: 'center', color: '#888', background: '#fff', borderRadius: 10 }}>No contacts found.</div>\r\n          ) : (\r\n            filtered.map((c: any) => (\r\n              <div key={c.id} style={{ background: '#fff', borderRadius: 10, boxShadow: '0 2px 10px rgba(80,120,200,0.10)', border: '1.5px solid #f0f4fa', padding: 16, display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n                {adminView && (\r\n                  <div style={{ marginBottom: 4 }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selected.includes(c.id)}\r\n                      onChange={e => setSelected(e.target.checked ? [...selected, c.id] : selected.filter(id => id !== c.id))}\r\n                      aria-label={`Select contact ${c.name}`}\r\n                      style={{ verticalAlign: 'middle', transform: 'scale(1.25)', marginRight: 8 }}\r\n                    />\r\n                  </div>\r\n                )}\r\n                <div><span style={{ fontWeight: 700, color: '#2563eb' }}>Name:</span> {c.name}</div>\r\n                <div><span style={{ fontWeight: 700, color: '#2563eb' }}>Email:</span> {c.email}</div>\r\n                <div><span style={{ fontWeight: 700, color: '#2563eb' }}>Phone:</span> {c.phone}</div>\r\n                <div><span style={{ fontWeight: 700, color: '#2563eb' }}>Account:</span> {c.accountId\r\n                  ? <span style={{ color: '#0052cc' }}>{accounts.find((acc: any) => acc.id === c.accountId)?.name || <span style={{ color: '#bbb' }}>Unknown</span>}</span>\r\n                  : <span style={{ color: '#bbb' }}>No account</span>\r\n                }</div>\r\n                {adminView && (\r\n                  <div style={{ marginTop: 8 }}>\r\n                    <button\r\n                      style={{ background: '#e53935', color: '#fff', fontWeight: 700, fontSize: 16, width: '100%', borderRadius: 8, padding: '12px 0', letterSpacing: '0.5px', boxShadow: '0 1px 4px rgba(229,57,53,0.07)' }}\r\n                      onClick={async () => {\r\n                        if (!window.confirm(`Delete contact '${c.name}'?`)) return;\r\n                        try {\r\n                          const res = await fetch(`/api/contacts/${c.id}`, {\r\n                            method: 'DELETE',\r\n                            headers: { 'Content-Type': 'application/json' },\r\n                          });\r\n                          if (res.ok) {\r\n                            setContacts(contacts.filter(contact => contact.id !== c.id));\r\n                          } else {\r\n                            alert('Delete failed');\r\n                          }\r\n                        } catch {\r\n                          alert('Delete failed');\r\n                        }\r\n                      }}\r\n                    >Delete</button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <table className=\"contacts-table min-w-full text-base\" style={{ width: '100%', tableLayout: 'fixed', borderSpacing: '0 24px' }}>\r\n          <thead>\r\n            <tr className=\"bg-gray-100 text-gray-800 font-semibold\">\r\n              {adminView && (\r\n                <th className=\"px-4 py-3 text-left\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selected.length === filtered.length && filtered.length > 0}\r\n                    onChange={e => setSelected(e.target.checked ? filtered.map(c => c.id) : [])}\r\n                    aria-label=\"Select all\"\r\n                  />\r\n                </th>\r\n              )}\r\n              <th className=\"px-6 py-3 text-left rounded-tl-lg text-xl font-bold\">Name</th>\r\n              <th className=\"px-6 py-3 text-left text-xl font-bold\">Email</th>\r\n              <th className=\"px-6 py-3 text-left text-xl font-bold\">Phone</th>\r\n              <th className=\"px-6 py-3 text-left rounded-tr-lg text-xl font-bold\">Account</th>\r\n              {adminView && <th className=\"px-6 py-3 text-left text-xl font-bold\">Actions</th>}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filtered.length === 0 ? (\r\n              <tr><td colSpan={adminView ? 6 : 4} className=\"py-8 text-center text-gray-400\">No contacts found.</td></tr>\r\n            ) : (\r\n              filtered.map((c: any) => (\r\n                <tr key={c.id} className=\"border-b last:border-b-0 hover:bg-gray-50 transition\" style={{ height: 72 }}>\r\n                  {adminView && (\r\n                    <td className=\"px-4 py-3\" style={{ textAlign: 'center', verticalAlign: 'middle' }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selected.includes(c.id)}\r\n                        onChange={e => setSelected(e.target.checked ? [...selected, c.id] : selected.filter(id => id !== c.id))}\r\n                        aria-label={`Select contact ${c.name}`}\r\n                        style={{ verticalAlign: 'middle', transform: 'scale(1.25)' }}\r\n                      />\r\n                    </td>\r\n                  )}\r\n                  <td className=\"px-6 py-3 font-semibold text-gray-900 text-lg\" data-label=\"Name\">{c.name}</td>\r\n                  <td className=\"px-6 py-3 text-gray-700 text-lg\" data-label=\"Email\">{c.email}</td>\r\n                  <td className=\"px-6 py-3 text-gray-700 text-lg\" data-label=\"Phone\">{c.phone}</td>\r\n                  <td className=\"px-6 py-3\" data-label=\"Account\">\r\n                    {c.accountId\r\n                      ? <span className=\"font-medium text-blue-700 bg-blue-100 px-3 py-1 rounded\">{accounts.find((acc: any) => acc.id === c.accountId)?.name || <span className=\"text-gray-400\">Unknown</span>}</span>\r\n                      : <span className=\"text-gray-400 bg-gray-100 px-3 py-1 rounded\">No account</span>\r\n                    }\r\n                  </td>\r\n                  {adminView && (\r\n                    <td className=\"px-6 py-3\" data-label=\"Actions\">\r\n                      <button\r\n                        className=\"bg-red-600 hover:bg-red-700 text-white font-bold px-7 py-3 rounded-xl shadow-md transition\"\r\n                        style={{ background: '#e53935', color: '#fff', fontWeight: 700, fontSize: 16, marginLeft: 12, marginRight: 12, minWidth: 120, letterSpacing: '0.5px' }}\r\n                        onClick={async () => {\r\n                          if (!window.confirm(`Delete contact '${c.name}'?`)) return;\r\n                          try {\r\n                            const res = await fetch(`/api/contacts/${c.id}`, {\r\n                              method: 'DELETE',\r\n                              headers: { 'Content-Type': 'application/json' },\r\n                            });\r\n                            if (res.ok) {\r\n                              setContacts(contacts.filter(contact => contact.id !== c.id));\r\n                            } else {\r\n                              alert('Delete failed');\r\n                            }\r\n                          } catch {\r\n                            alert('Delete failed');\r\n                          }\r\n                        }}\r\n                      >Delete</button>\r\n                    </td>\r\n                  )}\r\n                </tr>\r\n              ))\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 613, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/components/ui/Modal.tsx"],"sourcesContent":["import React from 'react';\r\n\r\nexport default function Modal({ open, onClose, title, children }: {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  title: string;\r\n  children: React.ReactNode;\r\n}) {\r\n  if (!open) return null;\r\n  return (\r\n    <div style={{\r\n      position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh',\r\n      background: 'rgba(0,0,0,0.3)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000\r\n    }}>\r\n      <div style={{ background: '#fff', borderRadius: 8, minWidth: 400, padding: 32, position: 'relative' }}>\r\n        <button onClick={onClose} style={{ position: 'absolute', top: 12, right: 12, background: 'none', border: 'none', fontSize: 20, cursor: 'pointer' }}>Ã—</button>\r\n        <h2 style={{ marginBottom: 24 }}>{title}</h2>\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEe,SAAS,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAK7D;IACC,IAAI,CAAC,MAAM,OAAO;IAClB,qBACE,0PAAC;QAAI,OAAO;YACV,UAAU;YAAS,KAAK;YAAG,MAAM;YAAG,OAAO;YAAS,QAAQ;YAC5D,YAAY;YAAmB,SAAS;YAAQ,YAAY;YAAU,gBAAgB;YAAU,QAAQ;QAC1G;kBACE,cAAA,0PAAC;YAAI,OAAO;gBAAE,YAAY;gBAAQ,cAAc;gBAAG,UAAU;gBAAK,SAAS;gBAAI,UAAU;YAAW;;8BAClG,0PAAC;oBAAO,SAAS;oBAAS,OAAO;wBAAE,UAAU;wBAAY,KAAK;wBAAI,OAAO;wBAAI,YAAY;wBAAQ,QAAQ;wBAAQ,UAAU;wBAAI,QAAQ;oBAAU;8BAAG;;;;;;8BACpJ,0PAAC;oBAAG,OAAO;wBAAE,cAAc;oBAAG;8BAAI;;;;;;gBACjC;;;;;;;;;;;;AAIT"}},
    {"offset": {"line": 687, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/components/forms/ContactForm.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\n\r\nexport default function ContactForm({ onSubmit, initialData }: {\r\n  onSubmit: (data: any) => void;\r\n  initialData?: any;\r\n}) {\r\n  const [name, setName] = useState(initialData?.name || '');\r\n  const [email, setEmail] = useState(initialData?.email || '');\r\n  const [phone, setPhone] = useState(initialData?.phone || '');\r\n  const [accountId, setAccountId] = useState(initialData?.accountId || '');\r\n  const [accounts, setAccounts] = useState<any[]>([]);\r\n  const [loadingAccounts, setLoadingAccounts] = useState(true);\r\n\r\n  useEffect(() => {\r\n    setLoadingAccounts(true);\r\n    fetch('/api/accounts')\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        setAccounts(Array.isArray(data) ? data : []);\r\n        console.log('Fetched accounts:', data); // Debug log\r\n        setLoadingAccounts(false);\r\n      })\r\n      .catch(() => setLoadingAccounts(false));\r\n  }, []);\r\n\r\n  return (\r\n    <form onSubmit={e => { e.preventDefault(); onSubmit({ name, email, phone, accountId }); }}>\r\n      <div style={{ marginBottom: 12 }}>\r\n        <label>Name</label><br />\r\n        <input value={name} onChange={e => setName(e.target.value)} required style={{ width: '100%', padding: 8, borderRadius: 4, border: '1px solid #ccc' }} />\r\n      </div>\r\n      <div style={{ marginBottom: 12 }}>\r\n        <label>Email</label><br />\r\n        <input type=\"email\" value={email} onChange={e => setEmail(e.target.value)} required style={{ width: '100%', padding: 8, borderRadius: 4, border: '1px solid #ccc' }} />\r\n      </div>\r\n      <div style={{ marginBottom: 12 }}>\r\n        <label>Phone</label><br />\r\n        <input value={phone} onChange={e => setPhone(e.target.value)} style={{ width: '100%', padding: 8, borderRadius: 4, border: '1px solid #ccc' }} />\r\n      </div>\r\n      <div style={{ marginBottom: 12 }}>\r\n        <label>Account (optional)</label><br />\r\n        {loadingAccounts ? (\r\n          <div style={{ color: '#888', padding: 8 }}>Loading accounts...</div>\r\n        ) : (\r\n          <select value={accountId} onChange={e => setAccountId(e.target.value)} style={{ width: '100%', padding: 8, borderRadius: 4, border: '1px solid #ccc' }}>\r\n            <option value=\"\">No account</option>\r\n            {accounts.map((acc: any) => (\r\n              <option key={acc.id} value={acc.id}>{acc.name}</option>\r\n            ))}\r\n          </select>\r\n        )}\r\n      </div>\r\n      <button type=\"submit\" style={{ background: '#0052cc', color: '#fff', border: 'none', borderRadius: 6, padding: '10px 24px', fontWeight: 600, cursor: 'pointer', marginTop: 8 }}>Save Contact</button>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AADA;;;AAGe,SAAS,YAAY,EAAE,QAAQ,EAAE,WAAW,EAG1D;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6NAAQ,EAAC,aAAa,QAAQ;IACtD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAC,aAAa,SAAS;IACzD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAC,aAAa,SAAS;IACzD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6NAAQ,EAAC,aAAa,aAAa;IACrE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,6NAAQ,EAAQ,EAAE;IAClD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,6NAAQ,EAAC;IAEvD,IAAA,8NAAS,EAAC;QACR,mBAAmB;QACnB,MAAM,iBACH,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI,IACpB,IAAI,CAAC,CAAA;YACJ,YAAY,MAAM,OAAO,CAAC,QAAQ,OAAO,EAAE;YAC3C,QAAQ,GAAG,CAAC,qBAAqB,OAAO,YAAY;YACpD,mBAAmB;QACrB,GACC,KAAK,CAAC,IAAM,mBAAmB;IACpC,GAAG,EAAE;IAEL,qBACE,0PAAC;QAAK,UAAU,CAAA;YAAO,EAAE,cAAc;YAAI,SAAS;gBAAE;gBAAM;gBAAO;gBAAO;YAAU;QAAI;;0BACtF,0PAAC;gBAAI,OAAO;oBAAE,cAAc;gBAAG;;kCAC7B,0PAAC;kCAAM;;;;;;kCAAY,0PAAC;;;;;kCACpB,0PAAC;wBAAM,OAAO;wBAAM,UAAU,CAAA,IAAK,QAAQ,EAAE,MAAM,CAAC,KAAK;wBAAG,QAAQ;wBAAC,OAAO;4BAAE,OAAO;4BAAQ,SAAS;4BAAG,cAAc;4BAAG,QAAQ;wBAAiB;;;;;;;;;;;;0BAErJ,0PAAC;gBAAI,OAAO;oBAAE,cAAc;gBAAG;;kCAC7B,0PAAC;kCAAM;;;;;;kCAAa,0PAAC;;;;;kCACrB,0PAAC;wBAAM,MAAK;wBAAQ,OAAO;wBAAO,UAAU,CAAA,IAAK,SAAS,EAAE,MAAM,CAAC,KAAK;wBAAG,QAAQ;wBAAC,OAAO;4BAAE,OAAO;4BAAQ,SAAS;4BAAG,cAAc;4BAAG,QAAQ;wBAAiB;;;;;;;;;;;;0BAEpK,0PAAC;gBAAI,OAAO;oBAAE,cAAc;gBAAG;;kCAC7B,0PAAC;kCAAM;;;;;;kCAAa,0PAAC;;;;;kCACrB,0PAAC;wBAAM,OAAO;wBAAO,UAAU,CAAA,IAAK,SAAS,EAAE,MAAM,CAAC,KAAK;wBAAG,OAAO;4BAAE,OAAO;4BAAQ,SAAS;4BAAG,cAAc;4BAAG,QAAQ;wBAAiB;;;;;;;;;;;;0BAE9I,0PAAC;gBAAI,OAAO;oBAAE,cAAc;gBAAG;;kCAC7B,0PAAC;kCAAM;;;;;;kCAA0B,0PAAC;;;;;oBACjC,gCACC,0PAAC;wBAAI,OAAO;4BAAE,OAAO;4BAAQ,SAAS;wBAAE;kCAAG;;;;;6CAE3C,0PAAC;wBAAO,OAAO;wBAAW,UAAU,CAAA,IAAK,aAAa,EAAE,MAAM,CAAC,KAAK;wBAAG,OAAO;4BAAE,OAAO;4BAAQ,SAAS;4BAAG,cAAc;4BAAG,QAAQ;wBAAiB;;0CACnJ,0PAAC;gCAAO,OAAM;0CAAG;;;;;;4BAChB,SAAS,GAAG,CAAC,CAAC,oBACb,0PAAC;oCAAoB,OAAO,IAAI,EAAE;8CAAG,IAAI,IAAI;mCAAhC,IAAI,EAAE;;;;;;;;;;;;;;;;;0BAK3B,0PAAC;gBAAO,MAAK;gBAAS,OAAO;oBAAE,YAAY;oBAAW,OAAO;oBAAQ,QAAQ;oBAAQ,cAAc;oBAAG,SAAS;oBAAa,YAAY;oBAAK,QAAQ;oBAAW,WAAW;gBAAE;0BAAG;;;;;;;;;;;;AAGtL"}},
    {"offset": {"line": 930, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/app/%28app%29/contacts/page.tsx"],"sourcesContent":["\"use client\";\r\nimport ContactsTable from '../../../components/tables/ContactsTable';\r\nimport { useState, useEffect } from 'react';\r\nimport Modal from '../../../components/ui/Modal';\r\nimport ContactForm from '../../../components/forms/ContactForm';\r\nimport { useAuth } from '../../../src/auth/AuthProvider';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nexport default function ContactsPage() {\r\n  const [search, setSearch] = useState(\"\");\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const [refresh, setRefresh] = useState(0);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const { user, role, loading } = useAuth();\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    if (!loading && role === 'ADMIN') {\r\n      router.replace('/admin/contacts');\r\n    }\r\n  }, [role, loading, router]);\r\n\r\n  const handleCreate = async (data: any) => {\r\n    setSaving(true);\r\n    setError(\"\");\r\n    try {\r\n      const res = await fetch('/api/contacts', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(data),\r\n      });\r\n      if (!res.ok) throw new Error('Failed to add contact');\r\n      setModalOpen(false);\r\n      setRefresh(r => r + 1);\r\n    } catch (e: any) {\r\n      setError(e.message || 'Error');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) return null;\r\n\r\n  return (\r\n    <div style={{ padding: 32, background: '#f8f9fb', minHeight: '100vh', fontFamily: 'Inter, Arial, sans-serif' }}>\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 32 }}>\r\n        <h1 style={{ fontSize: 32, fontWeight: 800, color: '#222' }}>Contacts</h1>\r\n        <button onClick={() => setModalOpen(true)} style={{ background: '#0052cc', color: '#fff', border: 'none', borderRadius: 8, padding: '12px 28px', fontWeight: 700, fontSize: 16, cursor: 'pointer', boxShadow: '0 2px 8px rgba(0,82,204,0.08)' }}>+ New Contact</button>\r\n      </div>\r\n      <div style={{ marginBottom: 24, display: 'flex', justifyContent: 'flex-end' }}>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search contacts...\"\r\n          value={search}\r\n          onChange={e => setSearch(e.target.value)}\r\n          style={{ padding: '10px 16px', borderRadius: 8, border: '1px solid #d1d5db', fontSize: 16, width: 320 }}\r\n        />\r\n      </div>\r\n      <div style={{ background: '#fff', borderRadius: 16, padding: 32, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n        <ContactsTable search={search} refresh={refresh} />\r\n      </div>\r\n      <Modal open={modalOpen} onClose={() => setModalOpen(false)} title=\"New Contact\">\r\n        <ContactForm onSubmit={handleCreate} />\r\n        {saving && <div style={{ color: '#0052cc', marginTop: 12 }}>Saving...</div>}\r\n        {error && <div style={{ color: 'red', marginTop: 12 }}>{error}</div>}\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AANA;;;;;;;;AAQe,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6NAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6NAAQ,EAAC;IAC3C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6NAAQ,EAAC;IACrC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAC;IACnC,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAA,mJAAO;IACvC,MAAM,SAAS,IAAA,2JAAS;IAExB,IAAA,8NAAS,EAAC;QACR,IAAI,CAAC,WAAW,SAAS,SAAS;YAChC,OAAO,OAAO,CAAC;QACjB;IACF,GAAG;QAAC;QAAM;QAAS;KAAO;IAE1B,MAAM,eAAe,OAAO;QAC1B,UAAU;QACV,SAAS;QACT,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,iBAAiB;gBACvC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;YAC7B,aAAa;YACb,WAAW,CAAA,IAAK,IAAI;QACtB,EAAE,OAAO,GAAQ;YACf,SAAS,EAAE,OAAO,IAAI;QACxB,SAAU;YACR,UAAU;QACZ;IACF;IAEA,IAAI,SAAS,OAAO;IAEpB,qBACE,0PAAC;QAAI,OAAO;YAAE,SAAS;YAAI,YAAY;YAAW,WAAW;YAAS,YAAY;QAA2B;;0BAC3G,0PAAC;gBAAI,OAAO;oBAAE,SAAS;oBAAQ,gBAAgB;oBAAiB,YAAY;oBAAU,cAAc;gBAAG;;kCACrG,0PAAC;wBAAG,OAAO;4BAAE,UAAU;4BAAI,YAAY;4BAAK,OAAO;wBAAO;kCAAG;;;;;;kCAC7D,0PAAC;wBAAO,SAAS,IAAM,aAAa;wBAAO,OAAO;4BAAE,YAAY;4BAAW,OAAO;4BAAQ,QAAQ;4BAAQ,cAAc;4BAAG,SAAS;4BAAa,YAAY;4BAAK,UAAU;4BAAI,QAAQ;4BAAW,WAAW;wBAAgC;kCAAG;;;;;;;;;;;;0BAEnP,0PAAC;gBAAI,OAAO;oBAAE,cAAc;oBAAI,SAAS;oBAAQ,gBAAgB;gBAAW;0BAC1E,cAAA,0PAAC;oBACC,MAAK;oBACL,aAAY;oBACZ,OAAO;oBACP,UAAU,CAAA,IAAK,UAAU,EAAE,MAAM,CAAC,KAAK;oBACvC,OAAO;wBAAE,SAAS;wBAAa,cAAc;wBAAG,QAAQ;wBAAqB,UAAU;wBAAI,OAAO;oBAAI;;;;;;;;;;;0BAG1G,0PAAC;gBAAI,OAAO;oBAAE,YAAY;oBAAQ,cAAc;oBAAI,SAAS;oBAAI,WAAW;gBAA6B;0BACvG,cAAA,0PAAC,6JAAa;oBAAC,QAAQ;oBAAQ,SAAS;;;;;;;;;;;0BAE1C,0PAAC,iJAAK;gBAAC,MAAM;gBAAW,SAAS,IAAM,aAAa;gBAAQ,OAAM;;kCAChE,0PAAC,0JAAW;wBAAC,UAAU;;;;;;oBACtB,wBAAU,0PAAC;wBAAI,OAAO;4BAAE,OAAO;4BAAW,WAAW;wBAAG;kCAAG;;;;;;oBAC3D,uBAAS,0PAAC;wBAAI,OAAO;4BAAE,OAAO;4BAAO,WAAW;wBAAG;kCAAI;;;;;;;;;;;;;;;;;;AAIhE"}}]
}