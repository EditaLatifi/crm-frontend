{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/src/auth/tokenStore.ts"],"sourcesContent":["// src/auth/tokenStore.ts\r\n// In-memory access token store (never trust localStorage for security)\r\nlet accessToken: string | null = null;\r\n\r\nexport function getAccessToken() {\r\n  return accessToken;\r\n}\r\n\r\nexport function setAccessToken(token: string) {\r\n  accessToken = token;\r\n}\r\n\r\nexport function clearAccessToken() {\r\n  accessToken = null;\r\n}\r\n\r\n// If you must use localStorage (fallback), wrap with clear comments and centralize logic here.\r\nexport function loadTokenFromStorage() {\r\n  if (typeof window !== 'undefined') {\r\n    accessToken = localStorage.getItem('accessToken');\r\n  }\r\n}\r\n\r\nexport function saveTokenToStorage() {\r\n  if (typeof window !== 'undefined' && accessToken) {\r\n    localStorage.setItem('accessToken', accessToken);\r\n  }\r\n}\r\n\r\nexport function clearTokenFromStorage() {\r\n  if (typeof window !== 'undefined') {\r\n    localStorage.removeItem('accessToken');\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,yBAAyB;AACzB,uEAAuE;AACvE,IAAI,cAA6B;AAE1B,SAAS;IACd,OAAO;AACT;AAEO,SAAS,eAAe,KAAa;IAC1C,cAAc;AAChB;AAEO,SAAS;IACd,cAAc;AAChB;AAGO,SAAS;IACd;;AAGF;AAEO,SAAS;IACd;;AAGF;AAEO,SAAS;IACd;;AAGF"}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/src/api/client.ts"],"sourcesContent":["// src/api/client.ts\r\nimport { getAccessToken, setAccessToken, clearAccessToken } from '../auth/tokenStore';\r\n\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\n\r\nexport type ApiError = {\r\n  status: number;\r\n  message: string;\r\n};\r\n\r\nasync function fetchWithAuth(input: RequestInfo, init: RequestInit = {}, retry = true): Promise<any> {\r\n  let token = getAccessToken();\r\n  const headers = new Headers(init.headers || {});\r\n  if (token) headers.set('Authorization', `Bearer ${token}`);\r\n  let res = await fetch(`${API_BASE_URL}${input}`, { ...init, headers, credentials: 'include' });\r\n  if (res.status === 401 && retry) {\r\n    // Try refresh\r\n    const refreshed = await refreshToken();\r\n    if (refreshed) {\r\n      token = getAccessToken();\r\n      headers.set('Authorization', `Bearer ${token}`);\r\n      res = await fetch(`${API_BASE_URL}${input}`, { ...init, headers, credentials: 'include' });\r\n    } else {\r\n      clearAccessToken();\r\n      throw { status: 401, message: 'Session expired' };\r\n    }\r\n  }\r\n  if (!res.ok) {\r\n    let message = 'Unknown error';\r\n    try { message = (await res.json()).message || message; } catch {}\r\n    throw { status: res.status, message };\r\n  }\r\n  if (res.status === 204) return null;\r\n  return res.json();\r\n}\r\n\r\nasync function refreshToken(): Promise<boolean> {\r\n  try {\r\n    const res = await fetch(`${API_BASE_URL}/auth/refresh`, { method: 'POST', credentials: 'include' });\r\n    if (!res.ok) return false;\r\n    const data = await res.json();\r\n    if (data.accessToken) {\r\n      setAccessToken(data.accessToken);\r\n      return true;\r\n    }\r\n    return false;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const api = {\r\n  get: (url: string) => fetchWithAuth(url, { method: 'GET' }),\r\n  post: (url: string, body?: any) => fetchWithAuth(url, { method: 'POST', body: JSON.stringify(body), headers: { 'Content-Type': 'application/json' } }),\r\n  patch: (url: string, body?: any) => fetchWithAuth(url, { method: 'PATCH', body: JSON.stringify(body), headers: { 'Content-Type': 'application/json' } }),\r\n  delete: (url: string) => fetchWithAuth(url, { method: 'DELETE' }),\r\n};\r\n\r\n// Typed helpers (example)\r\nexport async function login(email: string, password: string) {\r\n  return api.post('/auth/login', { email, password });\r\n}\r\n\r\nexport async function getMe() {\r\n  return api.get('/users/me');\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA,oBAAoB;AACpB;;AAEA,MAAM,eAAe,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAOxD,eAAe,cAAc,KAAkB,EAAE,OAAoB,CAAC,CAAC,EAAE,QAAQ,IAAI;IACnF,IAAI,QAAQ,IAAA,uJAAc;IAC1B,MAAM,UAAU,IAAI,QAAQ,KAAK,OAAO,IAAI,CAAC;IAC7C,IAAI,OAAO,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;IACzD,IAAI,MAAM,MAAM,MAAM,GAAG,eAAe,OAAO,EAAE;QAAE,GAAG,IAAI;QAAE;QAAS,aAAa;IAAU;IAC5F,IAAI,IAAI,MAAM,KAAK,OAAO,OAAO;QAC/B,cAAc;QACd,MAAM,YAAY,MAAM;QACxB,IAAI,WAAW;YACb,QAAQ,IAAA,uJAAc;YACtB,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;YAC9C,MAAM,MAAM,MAAM,GAAG,eAAe,OAAO,EAAE;gBAAE,GAAG,IAAI;gBAAE;gBAAS,aAAa;YAAU;QAC1F,OAAO;YACL,IAAA,yJAAgB;YAChB,MAAM;gBAAE,QAAQ;gBAAK,SAAS;YAAkB;QAClD;IACF;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,IAAI,UAAU;QACd,IAAI;YAAE,UAAU,CAAC,MAAM,IAAI,IAAI,EAAE,EAAE,OAAO,IAAI;QAAS,EAAE,OAAM,CAAC;QAChE,MAAM;YAAE,QAAQ,IAAI,MAAM;YAAE;QAAQ;IACtC;IACA,IAAI,IAAI,MAAM,KAAK,KAAK,OAAO;IAC/B,OAAO,IAAI,IAAI;AACjB;AAEA,eAAe;IACb,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,aAAa,CAAC,EAAE;YAAE,QAAQ;YAAQ,aAAa;QAAU;QACjG,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO;QACpB,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI,KAAK,WAAW,EAAE;YACpB,IAAA,uJAAc,EAAC,KAAK,WAAW;YAC/B,OAAO;QACT;QACA,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,MAAM,MAAM;IACjB,KAAK,CAAC,MAAgB,cAAc,KAAK;YAAE,QAAQ;QAAM;IACzD,MAAM,CAAC,KAAa,OAAe,cAAc,KAAK;YAAE,QAAQ;YAAQ,MAAM,KAAK,SAAS,CAAC;YAAO,SAAS;gBAAE,gBAAgB;YAAmB;QAAE;IACpJ,OAAO,CAAC,KAAa,OAAe,cAAc,KAAK;YAAE,QAAQ;YAAS,MAAM,KAAK,SAAS,CAAC;YAAO,SAAS;gBAAE,gBAAgB;YAAmB;QAAE;IACtJ,QAAQ,CAAC,MAAgB,cAAc,KAAK;YAAE,QAAQ;QAAS;AACjE;AAGO,eAAe,MAAM,KAAa,EAAE,QAAgB;IACzD,OAAO,IAAI,IAAI,CAAC,eAAe;QAAE;QAAO;IAAS;AACnD;AAEO,eAAe;IACpB,OAAO,IAAI,GAAG,CAAC;AACjB"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/src/auth/AuthProvider.tsx"],"sourcesContent":["// src/auth/AuthProvider.tsx\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { getMe, login as apiLogin } from '../api/client';\r\nimport { getAccessToken, setAccessToken, clearAccessToken, loadTokenFromStorage, saveTokenToStorage, clearTokenFromStorage } from './tokenStore';\r\n\r\nexport type User = {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n  role: 'ADMIN' | 'USER';\r\n};\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  role: 'ADMIN' | 'USER' | null;\r\n  accessToken: string | null;\r\n  login: (email: string, password: string) => Promise<void>;\r\n  logout: () => void;\r\n  loading: boolean;\r\n  error: string | null;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [accessToken, setAccessTokenState] = useState<string | null>(getAccessToken());\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // On mount, try to load token from storage (if fallback is used)\r\n  useEffect(() => {\r\n    loadTokenFromStorage();\r\n    const token = getAccessToken();\r\n    if (token) setAccessTokenState(token);\r\n    bootstrapUser();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  async function bootstrapUser() {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const me = await getMe();\r\n      setUser(me);\r\n    } catch (err: any) {\r\n      setUser(null);\r\n      if (err.status === 401) clearAccessToken();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function login(email: string, password: string) {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const data = await apiLogin(email, password);\r\n      if (data.accessToken) {\r\n        setAccessToken(data.accessToken);\r\n        setAccessTokenState(data.accessToken);\r\n        saveTokenToStorage(); // fallback only\r\n      }\r\n      await bootstrapUser();\r\n    } catch (err: any) {\r\n      setError(err.message || 'Login failed');\r\n      setUser(null);\r\n      clearAccessToken();\r\n      clearTokenFromStorage();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  function logout() {\r\n    setUser(null);\r\n    clearAccessToken();\r\n    clearTokenFromStorage();\r\n    setAccessTokenState(null);\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, role: user?.role || null, accessToken, login, logout, loading, error }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const ctx = useContext(AuthContext);\r\n  if (!ctx) throw new Error('useAuth must be used within AuthProvider');\r\n  return ctx;\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA,4BAA4B;AAC5B;AACA;AACA;;;;;AAmBA,MAAM,4BAAc,IAAA,kOAAa,EAA8B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6NAAQ,EAAc;IAC9C,MAAM,CAAC,aAAa,oBAAoB,GAAG,IAAA,6NAAQ,EAAgB,IAAA,uJAAc;IACjF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAgB;IAElD,iEAAiE;IACjE,IAAA,8NAAS,EAAC;QACR,IAAA,6JAAoB;QACpB,MAAM,QAAQ,IAAA,uJAAc;QAC5B,IAAI,OAAO,oBAAoB;QAC/B;IACA,2BAA2B;IAC7B,GAAG,EAAE;IAEL,eAAe;QACb,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,KAAK,MAAM,IAAA,yIAAK;YACtB,QAAQ;QACV,EAAE,OAAO,KAAU;YACjB,QAAQ;YACR,IAAI,IAAI,MAAM,KAAK,KAAK,IAAA,yJAAgB;QAC1C,SAAU;YACR,WAAW;QACb;IACF;IAEA,eAAe,MAAM,KAAa,EAAE,QAAgB;QAClD,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,OAAO,MAAM,IAAA,yIAAQ,EAAC,OAAO;YACnC,IAAI,KAAK,WAAW,EAAE;gBACpB,IAAA,uJAAc,EAAC,KAAK,WAAW;gBAC/B,oBAAoB,KAAK,WAAW;gBACpC,IAAA,2JAAkB,KAAI,gBAAgB;YACxC;YACA,MAAM;QACR,EAAE,OAAO,KAAU;YACjB,SAAS,IAAI,OAAO,IAAI;YACxB,QAAQ;YACR,IAAA,yJAAgB;YAChB,IAAA,8JAAqB;QACvB,SAAU;YACR,WAAW;QACb;IACF;IAEA,SAAS;QACP,QAAQ;QACR,IAAA,yJAAgB;QAChB,IAAA,8JAAqB;QACrB,oBAAoB;IACtB;IAEA,qBACE,0PAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM,MAAM,MAAM,QAAQ;YAAM;YAAa;YAAO;YAAQ;YAAS;QAAM;kBACvG;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,MAAM,IAAA,+NAAU,EAAC;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT"}},
    {"offset": {"line": 245, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/components/charts/TasksBarChart.tsx"],"sourcesContent":["import { Bar } from 'react-chartjs-2';\r\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend } from 'chart.js';\r\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\r\n\r\nexport default function TasksBarChart({ data }: { data: { labels: string[], values: number[] } }) {\r\n  return (\r\n    <div style={{ width: '100%', height: 300 }}>\r\n      <Bar\r\n        data={{\r\n          labels: data.labels,\r\n          datasets: [\r\n            {\r\n              label: 'Tasks',\r\n              data: data.values,\r\n              backgroundColor: '#0052cc',\r\n            },\r\n          ],\r\n        }}\r\n        options={{\r\n          responsive: true,\r\n          plugins: {\r\n            legend: { display: false },\r\n            title: { display: true, text: 'Tasks Overview' },\r\n          },\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AACA,qKAAO,CAAC,QAAQ,CAAC,6KAAa,EAAE,2KAAW,EAAE,0KAAU,EAAE,qKAAK,EAAE,uKAAO,EAAE,sKAAM;AAEhE,SAAS,cAAc,EAAE,IAAI,EAAoD;IAC9F,qBACE,0PAAC;QAAI,OAAO;YAAE,OAAO;YAAQ,QAAQ;QAAI;kBACvC,cAAA,0PAAC,6JAAG;YACF,MAAM;gBACJ,QAAQ,KAAK,MAAM;gBACnB,UAAU;oBACR;wBACE,OAAO;wBACP,MAAM,KAAK,MAAM;wBACjB,iBAAiB;oBACnB;iBACD;YACH;YACA,SAAS;gBACP,YAAY;gBACZ,SAAS;oBACP,QAAQ;wBAAE,SAAS;oBAAM;oBACzB,OAAO;wBAAE,SAAS;wBAAM,MAAM;oBAAiB;gBACjD;YACF;;;;;;;;;;;AAIR"}},
    {"offset": {"line": 300, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/components/charts/DealsPieChart.tsx"],"sourcesContent":["import { Pie } from 'react-chartjs-2';\r\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\r\nChartJS.register(ArcElement, Tooltip, Legend);\r\n\r\nexport default function DealsPieChart({ data }: { data: { labels: string[], values: number[] } }) {\r\n  return (\r\n    <div style={{ width: '100%', height: 300 }}>\r\n      <Pie\r\n        data={{\r\n          labels: data.labels,\r\n          datasets: [\r\n            {\r\n              label: 'Deals',\r\n              data: data.values,\r\n              backgroundColor: ['#0052cc', '#36a2eb', '#ffce56', '#e74c3c'],\r\n            },\r\n          ],\r\n        }}\r\n        options={{\r\n          responsive: true,\r\n          plugins: {\r\n            legend: { position: 'bottom' },\r\n            title: { display: true, text: 'Deals by Stage' },\r\n          },\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AACA,qKAAO,CAAC,QAAQ,CAAC,0KAAU,EAAE,uKAAO,EAAE,sKAAM;AAE7B,SAAS,cAAc,EAAE,IAAI,EAAoD;IAC9F,qBACE,0PAAC;QAAI,OAAO;YAAE,OAAO;YAAQ,QAAQ;QAAI;kBACvC,cAAA,0PAAC,6JAAG;YACF,MAAM;gBACJ,QAAQ,KAAK,MAAM;gBACnB,UAAU;oBACR;wBACE,OAAO;wBACP,MAAM,KAAK,MAAM;wBACjB,iBAAiB;4BAAC;4BAAW;4BAAW;4BAAW;yBAAU;oBAC/D;iBACD;YACH;YACA,SAAS;gBACP,YAAY;gBACZ,SAAS;oBACP,QAAQ;wBAAE,UAAU;oBAAS;oBAC7B,OAAO;wBAAE,SAAS;wBAAM,MAAM;oBAAiB;gBACjD;YACF;;;;;;;;;;;AAIR"}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/components/charts/TimeLineChart.tsx"],"sourcesContent":["import { Line } from 'react-chartjs-2';\r\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend } from 'chart.js';\r\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend);\r\n\r\nexport default function TimeLineChart({ data }: { data: { labels: string[], values: number[] } }) {\r\n  return (\r\n    <div style={{ width: '100%', height: 300 }}>\r\n      <Line\r\n        data={{\r\n          labels: data.labels,\r\n          datasets: [\r\n            {\r\n              label: 'Time Tracked (h)',\r\n              data: data.values,\r\n              borderColor: '#0052cc',\r\n              backgroundColor: 'rgba(0,82,204,0.1)',\r\n              tension: 0.4,\r\n            },\r\n          ],\r\n        }}\r\n        options={{\r\n          responsive: true,\r\n          plugins: {\r\n            legend: { display: false },\r\n            title: { display: true, text: 'Time Tracking' },\r\n          },\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AACA,qKAAO,CAAC,QAAQ,CAAC,6KAAa,EAAE,2KAAW,EAAE,4KAAY,EAAE,2KAAW,EAAE,qKAAK,EAAE,uKAAO,EAAE,sKAAM;AAE/E,SAAS,cAAc,EAAE,IAAI,EAAoD;IAC9F,qBACE,0PAAC;QAAI,OAAO;YAAE,OAAO;YAAQ,QAAQ;QAAI;kBACvC,cAAA,0PAAC,8JAAI;YACH,MAAM;gBACJ,QAAQ,KAAK,MAAM;gBACnB,UAAU;oBACR;wBACE,OAAO;wBACP,MAAM,KAAK,MAAM;wBACjB,aAAa;wBACb,iBAAiB;wBACjB,SAAS;oBACX;iBACD;YACH;YACA,SAAS;gBACP,YAAY;gBACZ,SAAS;oBACP,QAAQ;wBAAE,SAAS;oBAAM;oBACzB,OAAO;wBAAE,SAAS;wBAAM,MAAM;oBAAgB;gBAChD;YACF;;;;;;;;;;;AAIR"}},
    {"offset": {"line": 417, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/app/dashboard/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '../../src/auth/AuthProvider';\r\nimport TasksBarChart from '../../components/charts/TasksBarChart';\r\nimport DealsPieChart from '../../components/charts/DealsPieChart';\r\nimport TimeLineChart from '../../components/charts/TimeLineChart';\r\n\r\nexport default function DashboardPage() {\r\n\tconst { user, loading } = useAuth();\r\n\tconst router = useRouter();\r\n\tconst [tasksCount, setTasksCount] = useState(0);\r\n\tconst [dealsCount, setDealsCount] = useState(0);\r\n\tconst [timeTracked, setTimeTracked] = useState(0);\r\n\tconst [recentActivity, setRecentActivity] = useState<string[]>([]);\r\n\tconst [tasksChart, setTasksChart] = useState({ labels: [], values: [] });\r\n\tconst [dealsChart, setDealsChart] = useState({ labels: [], values: [] });\r\n\tconst [timeChart, setTimeChart] = useState({ labels: [], values: [] });\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!loading && !user) {\r\n\t\t\trouter.replace('/login');\r\n\t\t}\r\n\t}, [user, loading, router]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!user) return;\r\n\t\t// Fetch tasks summary\r\n\t\tfetch('/api/tasks')\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(data => {\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\tsetTasksCount(data.filter((t: any) => t.status !== 'DONE').length);\r\n\t\t\t\t\t// Chart: tasks by status\r\n\t\t\t\t\tconst statusMap: Record<string, number> = {};\r\n\t\t\t\t\tdata.forEach((t: any) => {\r\n\t\t\t\t\t\tstatusMap[t.status] = (statusMap[t.status] || 0) + 1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetTasksChart({\r\n\t\t\t\t\t\tlabels: Object.keys(statusMap),\r\n\t\t\t\t\t\tvalues: Object.values(statusMap),\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// Recent activity (tasks)\r\n\t\t\t\t\tsetRecentActivity((prev) => [\r\n\t\t\t\t\t\t...data.slice(0, 3).map((t: any) => `Task \"${t.title || t.name || t.id}\" status: ${t.status}`),\r\n\t\t\t\t\t\t...prev\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t// Fetch deals summary\r\n\t\tfetch('/api/deals')\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(data => {\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\tsetDealsCount(data.length);\r\n\t\t\t\t\t// Chart: deals by stage\r\n\t\t\t\t\tconst stageMap: Record<string, number> = {};\r\n\t\t\t\t\tdata.forEach((d: any) => {\r\n\t\t\t\t\t\tstageMap[d.stageId] = (stageMap[d.stageId] || 0) + 1;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetDealsChart({\r\n\t\t\t\t\t\tlabels: Object.keys(stageMap),\r\n\t\t\t\t\t\tvalues: Object.values(stageMap),\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetRecentActivity((prev) => [\r\n\t\t\t\t\t\t...data.slice(0, 2).map((d: any) => `Deal \"${d.name}\" stage: ${d.stageId}`),\r\n\t\t\t\t\t\t...prev\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t// Fetch time entries summary\r\n\t\tfetch('/api/time-entries')\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(data => {\r\n\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\t// Sum time tracked this week\r\n\t\t\t\t\tconst now = new Date();\r\n\t\t\t\t\tconst weekStart = new Date(now);\r\n\t\t\t\t\tweekStart.setDate(now.getDate() - now.getDay());\r\n\t\t\t\t\tconst weekEntries = data.filter((e: any) => new Date(e.startedAt) >= weekStart);\r\n\t\t\t\t\tconst totalMinutes = weekEntries.reduce((sum: number, e: any) => sum + (e.durationMinutes || 0), 0);\r\n\t\t\t\t\tsetTimeTracked(Math.round(totalMinutes / 60));\r\n\t\t\t\t\t// Chart: time tracked per day (last 7 days)\r\n\t\t\t\t\tconst days: string[] = [];\r\n\t\t\t\t\tconst values: number[] = [];\r\n\t\t\t\t\tfor (let i = 6; i >= 0; i--) {\r\n\t\t\t\t\t\tconst d = new Date(now);\r\n\t\t\t\t\t\td.setDate(now.getDate() - i);\r\n\t\t\t\t\t\tconst label = d.toLocaleDateString();\r\n\t\t\t\t\t\tdays.push(label);\r\n\t\t\t\t\t\tconst dayEntries = data.filter((e: any) => {\r\n\t\t\t\t\t\t\tconst ed = new Date(e.startedAt);\r\n\t\t\t\t\t\t\treturn ed.toLocaleDateString() === label;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvalues.push(dayEntries.reduce((sum: number, e: any) => sum + (e.durationMinutes || 0), 0) / 60);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeChart({ labels: days, values });\r\n\t\t\t\t\tsetRecentActivity((prev) => [\r\n\t\t\t\t\t\t...weekEntries.slice(0, 2).map((e: any) => `Time entry: ${e.durationMinutes} min on ${e.accountId || e.taskId}`),\r\n\t\t\t\t\t\t...prev\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<div style={{ padding: 32, background: '#f8f9fb', minHeight: '100vh', fontFamily: 'Inter, Arial, sans-serif' }}>\r\n\t\t\t<h1 style={{ marginBottom: 32, fontSize: 36, fontWeight: 800, color: '#222' }}>Dashboard</h1>\r\n\t\t\t<div style={{ display: 'flex', gap: 32, marginBottom: 40 }}>\r\n\t\t\t\t<div style={{ background: '#fff', padding: 32, borderRadius: 16, flex: 1, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n\t\t\t\t\t<h3 style={{ color: '#0052cc', fontWeight: 700, marginBottom: 8 }}>Active Tasks</h3>\r\n\t\t\t\t\t<div style={{ fontSize: 32, fontWeight: 700 }}>{tasksCount}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ background: '#fff', padding: 32, borderRadius: 16, flex: 1, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n\t\t\t\t\t<h3 style={{ color: '#36a2eb', fontWeight: 700, marginBottom: 8 }}>Deals in Pipeline</h3>\r\n\t\t\t\t\t<div style={{ fontSize: 32, fontWeight: 700 }}>{dealsCount}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ background: '#fff', padding: 32, borderRadius: 16, flex: 1, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n\t\t\t\t\t<h3 style={{ color: '#e67e22', fontWeight: 700, marginBottom: 8 }}>Time Tracked (this week)</h3>\r\n\t\t\t\t\t<div style={{ fontSize: 32, fontWeight: 700 }}>{timeTracked} h</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div style={{ display: 'flex', gap: 32, marginBottom: 40 }}>\r\n\t\t\t\t<div style={{ background: '#fff', borderRadius: 16, padding: 24, flex: 2, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n\t\t\t\t\t<TasksBarChart data={tasksChart} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ background: '#fff', borderRadius: 16, padding: 24, flex: 1, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n\t\t\t\t\t<DealsPieChart data={dealsChart} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{ background: '#fff', borderRadius: 16, padding: 24, flex: 2, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n\t\t\t\t\t<TimeLineChart data={timeChart} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div style={{ background: '#fff', borderRadius: 16, padding: 32, boxShadow: '0 2px 8px rgba(0,0,0,0.04)' }}>\r\n\t\t\t\t<h2 style={{ marginBottom: 16, fontWeight: 700, color: '#0052cc' }}>Recent Activity</h2>\r\n\t\t\t\t<ul style={{ fontSize: 16, color: '#444', lineHeight: 1.7 }}>\r\n\t\t\t\t\t{recentActivity.slice(0, 8).map((a, i) => <li key={i}>{a}</li>)}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"names":[],"mappings":"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"}}]
}