{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/src/auth/tokenStore.ts"],"sourcesContent":["// src/auth/tokenStore.ts\r\n// In-memory access token store (never trust localStorage for security)\r\nlet accessToken: string | null = null;\r\n\r\nexport function getAccessToken() {\r\n  console.log('[tokenStore] getAccessToken:', accessToken);\r\n  return accessToken;\r\n}\r\n\r\nexport function setAccessToken(token: string) {\r\n  accessToken = token;\r\n  console.log('[tokenStore] setAccessToken:', token);\r\n}\r\n\r\nexport function clearAccessToken() {\r\n  accessToken = null;\r\n  console.log('[tokenStore] clearAccessToken');\r\n}\r\n\r\n// If you must use localStorage (fallback), wrap with clear comments and centralize logic here.\r\n\r\nexport function loadTokenFromStorage() {\r\n  if (typeof window !== 'undefined') {\r\n    accessToken = localStorage.getItem('userToken');\r\n    console.log('[tokenStore] loadTokenFromStorage:', accessToken);\r\n  }\r\n}\r\n\r\n\r\nexport function saveTokenToStorage() {\r\n  if (typeof window !== 'undefined' && accessToken) {\r\n    localStorage.setItem('userToken', accessToken);\r\n    console.log('[tokenStore] saveTokenToStorage:', accessToken);\r\n  }\r\n}\r\n\r\n\r\nexport function clearTokenFromStorage() {\r\n  if (typeof window !== 'undefined') {\r\n    localStorage.removeItem('userToken');\r\n    console.log('[tokenStore] clearTokenFromStorage');\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,yBAAyB;AACzB,uEAAuE;AACvE,IAAI,cAA6B;AAE1B,SAAS;IACd,QAAQ,GAAG,CAAC,gCAAgC;IAC5C,OAAO;AACT;AAEO,SAAS,eAAe,KAAa;IAC1C,cAAc;IACd,QAAQ,GAAG,CAAC,gCAAgC;AAC9C;AAEO,SAAS;IACd,cAAc;IACd,QAAQ,GAAG,CAAC;AACd;AAIO,SAAS;IACd;;AAIF;AAGO,SAAS;IACd;;AAIF;AAGO,SAAS;IACd;;AAIF"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/src/api/client.ts"],"sourcesContent":["// src/api/client.ts\r\nimport { getAccessToken, setAccessToken, clearAccessToken} from '../auth/tokenStore';\r\n\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\n\r\nexport type ApiError = {\r\n  status: number;\r\n  message: string;\r\n};\r\n\r\nexport async function fetchWithAuth(input: RequestInfo, init: RequestInit = {}, retry = true): Promise<any> {\r\n  let token = getAccessToken();\r\n  const headers = new Headers(init.headers || {});\r\n  if (token) headers.set('Authorization', `Bearer ${token}`);\r\n  let url = typeof input === 'string' && /^https?:\\/\\//.test(input) ? input : `${API_BASE_URL}${input}`;\r\n  // Debug log for token and headers\r\n  console.log('fetchWithAuth', { url, token, headers: Object.fromEntries(headers.entries()) });\r\n  let res = await fetch(url, { ...init, headers, credentials: 'include' });\r\n  if (res.status === 401 && retry) {\r\n    // Try refresh\r\n    const refreshed = await refreshToken();\r\n    if (refreshed) {\r\n      token = getAccessToken();\r\n      headers.set('Authorization', `Bearer ${token}`);\r\n      res = await fetch(url, { ...init, headers, credentials: 'include' });\r\n    } else {\r\n      clearAccessToken();\r\n      throw { status: 401, message: 'Session expired' };\r\n    }\r\n  }\r\n  if (!res.ok) {\r\n    let message = 'Unknown error';\r\n    try { message = (await res.json()).message || message; } catch {}\r\n    throw { status: res.status, message };\r\n  }\r\n  if (res.status === 204) return null;\r\n  return res.json();\r\n}\r\n\r\nasync function refreshToken(): Promise<boolean> {\r\n  // No refresh token logic; always fail refresh\r\n  return false;\r\n}\r\n\r\nexport const api = {\r\n  get: (url: string) => fetchWithAuth(url, { method: 'GET' }),\r\n  post: (url: string, body?: any) => fetchWithAuth(url, { method: 'POST', body: JSON.stringify(body), headers: { 'Content-Type': 'application/json' } }),\r\n  patch: (url: string, body?: any) => fetchWithAuth(url, { method: 'PATCH', body: JSON.stringify(body), headers: { 'Content-Type': 'application/json' } }),\r\n  delete: (url: string) => fetchWithAuth(url, { method: 'DELETE' }),\r\n};\r\n\r\n// Typed helpers (example)\r\nexport async function login(email: string, password: string) {\r\n  return api.post('/auth/login', { email, password });\r\n}\r\n\r\nexport async function getMe(email: string) {\r\n  return api.post('/api/users/me', { email });\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA,oBAAoB;AACpB;;AAEA,MAAM,eAAe,6DAAmC;AAOjD,eAAe,cAAc,KAAkB,EAAE,OAAoB,CAAC,CAAC,EAAE,QAAQ,IAAI;IAC1F,IAAI,QAAQ,IAAA,uJAAc;IAC1B,MAAM,UAAU,IAAI,QAAQ,KAAK,OAAO,IAAI,CAAC;IAC7C,IAAI,OAAO,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;IACzD,IAAI,MAAM,OAAO,UAAU,YAAY,eAAe,IAAI,CAAC,SAAS,QAAQ,GAAG,eAAe,OAAO;IACrG,kCAAkC;IAClC,QAAQ,GAAG,CAAC,iBAAiB;QAAE;QAAK;QAAO,SAAS,OAAO,WAAW,CAAC,QAAQ,OAAO;IAAI;IAC1F,IAAI,MAAM,MAAM,MAAM,KAAK;QAAE,GAAG,IAAI;QAAE;QAAS,aAAa;IAAU;IACtE,IAAI,IAAI,MAAM,KAAK,OAAO,OAAO;QAC/B,cAAc;QACd,MAAM,YAAY,MAAM;QACxB;;aAIO;YACL,IAAA,yJAAgB;YAChB,MAAM;gBAAE,QAAQ;gBAAK,SAAS;YAAkB;QAClD;IACF;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,IAAI,UAAU;QACd,IAAI;YAAE,UAAU,CAAC,MAAM,IAAI,IAAI,EAAE,EAAE,OAAO,IAAI;QAAS,EAAE,OAAM,CAAC;QAChE,MAAM;YAAE,QAAQ,IAAI,MAAM;YAAE;QAAQ;IACtC;IACA,IAAI,IAAI,MAAM,KAAK,KAAK,OAAO;IAC/B,OAAO,IAAI,IAAI;AACjB;AAEA,eAAe;IACb,8CAA8C;IAC9C,OAAO;AACT;AAEO,MAAM,MAAM;IACjB,KAAK,CAAC,MAAgB,cAAc,KAAK;YAAE,QAAQ;QAAM;IACzD,MAAM,CAAC,KAAa,OAAe,cAAc,KAAK;YAAE,QAAQ;YAAQ,MAAM,KAAK,SAAS,CAAC;YAAO,SAAS;gBAAE,gBAAgB;YAAmB;QAAE;IACpJ,OAAO,CAAC,KAAa,OAAe,cAAc,KAAK;YAAE,QAAQ;YAAS,MAAM,KAAK,SAAS,CAAC;YAAO,SAAS;gBAAE,gBAAgB;YAAmB;QAAE;IACtJ,QAAQ,CAAC,MAAgB,cAAc,KAAK;YAAE,QAAQ;QAAS;AACjE;AAGO,eAAe,MAAM,KAAa,EAAE,QAAgB;IACzD,OAAO,IAAI,IAAI,CAAC,eAAe;QAAE;QAAO;IAAS;AACnD;AAEO,eAAe,MAAM,KAAa;IACvC,OAAO,IAAI,IAAI,CAAC,iBAAiB;QAAE;IAAM;AAC3C"}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/src/auth/AuthProvider.tsx"],"sourcesContent":["\"use client\";\r\n// src/auth/AuthProvider.tsx\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { getMe, login as apiLogin } from '../api/client';\r\nimport { getAccessToken, setAccessToken, clearAccessToken, loadTokenFromStorage, saveTokenToStorage, clearTokenFromStorage} from './tokenStore';\r\n\r\nexport type User = {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n  role: 'ADMIN' | 'USER';\r\n};\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  role: 'ADMIN' | 'USER' | null;\r\n  accessToken: string | null;\r\n  login: (email: string, password: string) => Promise<void>;\r\n  logout: () => void;\r\n  loading: boolean;\r\n  error: string | null;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [accessToken, setAccessTokenState] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // On mount, try to load token from storage (if fallback is used)\r\n  useEffect(() => {\r\n    loadTokenFromStorage();\r\n    const token = getAccessToken();\r\n    setAccessTokenState(token || null);\r\n    bootstrapUser();\r\n    setLoading(false);\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  async function bootstrapUser(email?: string) {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      if (!email) {\r\n        setUser(null);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      const me = await getMe(email);\r\n      setUser(me);\r\n    } catch (err: any) {\r\n      setUser(null);\r\n      if (err.status === 401) clearAccessToken();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function login(email: string, password: string) {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const data = await apiLogin(email, password);\r\n      console.log('[AuthProvider] login response:', data);\r\n      if (data.access_token) {\r\n        setAccessToken(data.access_token);\r\n        saveTokenToStorage();\r\n        setAccessTokenState(data.access_token);\r\n        console.log('[AuthProvider] set and saved accessToken:', data.access_token);\r\n      } else {\r\n        console.warn('[AuthProvider] No accessToken in login response!');\r\n      }\r\n      await bootstrapUser(email);\r\n    } catch (err: any) {\r\n      setError(err.message || 'Login failed');\r\n      setUser(null);\r\n      clearAccessToken();\r\n      clearTokenFromStorage();\r\n      console.error('[AuthProvider] login error:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  function logout() {\r\n    setUser(null);\r\n    clearAccessToken();\r\n    clearTokenFromStorage();\r\n    setAccessTokenState(null);\r\n  }\r\n\r\n  if (loading) return null;\r\n  return (\r\n    <AuthContext.Provider value={{ user, role: user?.role || null, accessToken, login, logout, loading, error }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const ctx = useContext(AuthContext);\r\n  if (!ctx) throw new Error('useAuth must be used within AuthProvider');\r\n  return ctx;\r\n}\r\n"],"names":[],"mappings":";;;;;;;AACA,4BAA4B;AAC5B;AACA;AACA;AAJA;;;;;AAuBA,MAAM,4BAAc,IAAA,kOAAa,EAA8B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6NAAQ,EAAc;IAC9C,MAAM,CAAC,aAAa,oBAAoB,GAAG,IAAA,6NAAQ,EAAgB;IACnE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAgB;IAElD,iEAAiE;IACjE,IAAA,8NAAS,EAAC;QACR,IAAA,6JAAoB;QACpB,MAAM,QAAQ,IAAA,uJAAc;QAC5B,oBAAoB,SAAS;QAC7B;QACA,WAAW;IACX,2BAA2B;IAC7B,GAAG,EAAE;IAEL,eAAe,cAAc,KAAc;QACzC,WAAW;QACX,SAAS;QACT,IAAI;YACF,IAAI,CAAC,OAAO;gBACV,QAAQ;gBACR,WAAW;gBACX;YACF;YACA,MAAM,KAAK,MAAM,IAAA,yIAAK,EAAC;YACvB,QAAQ;QACV,EAAE,OAAO,KAAU;YACjB,QAAQ;YACR,IAAI,IAAI,MAAM,KAAK,KAAK,IAAA,yJAAgB;QAC1C,SAAU;YACR,WAAW;QACb;IACF;IAEA,eAAe,MAAM,KAAa,EAAE,QAAgB;QAClD,WAAW;QACX,SAAS;QACT,IAAI;YACF,MAAM,OAAO,MAAM,IAAA,yIAAQ,EAAC,OAAO;YACnC,QAAQ,GAAG,CAAC,kCAAkC;YAC9C,IAAI,KAAK,YAAY,EAAE;gBACrB,IAAA,uJAAc,EAAC,KAAK,YAAY;gBAChC,IAAA,2JAAkB;gBAClB,oBAAoB,KAAK,YAAY;gBACrC,QAAQ,GAAG,CAAC,6CAA6C,KAAK,YAAY;YAC5E,OAAO;gBACL,QAAQ,IAAI,CAAC;YACf;YACA,MAAM,cAAc;QACtB,EAAE,OAAO,KAAU;YACjB,SAAS,IAAI,OAAO,IAAI;YACxB,QAAQ;YACR,IAAA,yJAAgB;YAChB,IAAA,8JAAqB;YACrB,QAAQ,KAAK,CAAC,+BAA+B;QAC/C,SAAU;YACR,WAAW;QACb;IACF;IAEA,SAAS;QACP,QAAQ;QACR,IAAA,yJAAgB;QAChB,IAAA,8JAAqB;QACrB,oBAAoB;IACtB;IAEA,IAAI,SAAS,OAAO;IACpB,qBACE,0PAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM,MAAM,MAAM,QAAQ;YAAM;YAAa;YAAO;YAAQ;YAAS;QAAM;kBACvG;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,MAAM,IAAA,+NAAU,EAAC;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT"}},
    {"offset": {"line": 259, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/app/providers.tsx"],"sourcesContent":["\"use client\";\r\nimport * as React from \"react\";\r\n\r\nimport { ChakraProvider } from \"@chakra-ui/react\";\r\nimport { AuthProvider } from '../src/auth/AuthProvider';\r\n\r\nexport function Providers({ children }: { children: React.ReactNode }) {\r\n  return (\r\n    <ChakraProvider>\r\n      <AuthProvider>{children}</AuthProvider>\r\n    </ChakraProvider>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAMO,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACnE,qBACE,0PAAC,2MAAc;kBACb,cAAA,0PAAC,wJAAY;sBAAE;;;;;;;;;;;AAGrB"}},
    {"offset": {"line": 307, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/components/ui/Sidebar.tsx"],"sourcesContent":["\"use client\";\r\nimport Link from \"next/link\";\r\nimport { usePathname, useRouter } from \"next/navigation\";\r\nimport {\r\n  Box,\r\n  VStack,\r\n  Flex,\r\n  Text,\r\n  Icon,\r\n  Button,\r\n} from \"@chakra-ui/react\";\r\nimport { useAuth } from '../../src/auth/AuthProvider';\r\nimport { FiGrid, FiUsers, FiUser, FiBriefcase, FiCheckSquare, FiClock, FiSettings } from \"react-icons/fi\";\r\n\r\n\r\nconst navItems = [\r\n  { href: \"/dashboard\", label: \"Dashboard\", icon: FiGrid },\r\n  { href: \"/accounts\", label: \"Accounts\", icon: FiUsers },\r\n  { href: \"/contacts\", label: \"Contacts\", icon: FiUser, admin: true },\r\n  { href: \"/deals\", label: \"Deals\", icon: FiBriefcase },\r\n  { href: \"/tasks\", label: \"Tasks\", icon: FiCheckSquare },\r\n  { href: \"/time\", label: \"Time Tracking\", icon: FiClock, admin: true },\r\n\r\n  { href: \"/profile\", label: \"Profile\", icon: FiUser },\r\n  { href: \"/reports\", label: \"Reports\", icon: FiSettings, admin: true },\r\n];\r\n\r\n\r\n\r\nexport default function Sidebar({ className = \"\", onClose }: { className?: string; onClose?: () => void }) {\r\n  const pathname = usePathname();\r\n  const router = useRouter();\r\n  const { user, logout } = useAuth();\r\n  const isAdmin = user?.role === 'ADMIN';\r\n  const handleLogout = () => {\r\n    logout();\r\n    router.replace('/login');\r\n    if (onClose) onClose();\r\n  };\r\n  return (\r\n    <Box\r\n      className={className}\r\n      bg=\"#f8fafc\"\r\n      minH=\"100vh\"\r\n      w=\"240px\"\r\n      px={0}\r\n      py={0}\r\n      position=\"fixed\"\r\n      left={0}\r\n      top={0}\r\n      borderRight=\"1px solid #e5e7eb\"\r\n      zIndex={10}\r\n      fontFamily=\"'Inter', system-ui, 'Segoe UI', 'Roboto', 'Arial', sans-serif\"\r\n    >\r\n      <Flex align=\"center\" mb={6} gap={2} px={4} py={5} bg=\"transparent\" borderBottom=\"1px solid #e5e7eb\">\r\n        <Icon viewBox=\"0 0 32 32\" boxSize={7} color=\"#2563eb\">\r\n          <circle cx=\"16\" cy=\"16\" r=\"16\" fill=\"#2563eb\" />\r\n          <text x=\"16\" y=\"21\" textAnchor=\"middle\" fontSize=\"16\" fill=\"#fff\" fontFamily=\"Arial\">CRM</text>\r\n        </Icon>\r\n        <Text fontWeight={700} fontSize=\"lg\" color=\"#23272f\">CRM</Text>\r\n        {onClose && (\r\n          <Button aria-label=\"Close sidebar\" onClick={onClose} ml=\"auto\" size=\"sm\" bg=\"#f8fafc\" color=\"#23272f\" _hover={{ bg: '#e5e7eb' }}>\r\n            Ã—\r\n          </Button>\r\n        )}\r\n      </Flex>\r\n      <VStack align=\"stretch\" spacing={0} px={1}>\r\n        {navItems.map((item) => {\r\n          if (item.admin && !isAdmin) return null;\r\n          const isActive = pathname.startsWith(item.href);\r\n          return (\r\n            <Link key={item.href} href={item.href} style={{ textDecoration: 'none' }}>\r\n              <Button\r\n                leftIcon={<item.icon size={18} color={isActive ? '#2563eb' : '#64748b'} />}\r\n                variant=\"ghost\"\r\n                fontWeight={isActive ? 600 : 400}\r\n                justifyContent=\"flex-start\"\r\n                w=\"full\"\r\n                size=\"md\"\r\n                borderRadius=\"md\"\r\n                bg={isActive ? '#e9effd' : 'transparent'}\r\n                color={isActive ? '#23272f' : '#64748b'}\r\n                _hover={{ bg: '#f1f5f9', color: '#23272f' }}\r\n                mb={0}\r\n                fontSize=\"14px\"\r\n                pl={5}\r\n                pr={2}\r\n                style={{ letterSpacing: 0.2, transition: 'background 0.15s, color 0.15s' }}\r\n                onClick={onClose}\r\n              >\r\n                {item.label}\r\n              </Button>\r\n            </Link>\r\n          );\r\n        })}\r\n      </VStack>\r\n      <Box px={4} mt={8}>\r\n        <Button\r\n          onClick={handleLogout}\r\n          w=\"full\"\r\n          colorScheme=\"red\"\r\n          variant=\"outline\"\r\n          borderRadius=\"md\"\r\n          fontWeight={700}\r\n          fontSize=\"15px\"\r\n          leftIcon={<span style={{fontWeight:900}}>&#x21bb;</span>}\r\n        >\r\n          Logout\r\n        </Button>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/src/routes/ProtectedRoute.tsx"],"sourcesContent":["\"use client\";\r\n// src/routes/ProtectedRoute.tsx\r\nimport { useAuth } from '../auth/AuthProvider';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useEffect } from 'react';\r\n\r\ntype ProtectedRouteProps = {\r\n  children: React.ReactNode;\r\n  role?: 'ADMIN' | 'USER'; // if provided, restrict to this role\r\n};\r\n\r\nexport default function ProtectedRoute({ children, role }: ProtectedRouteProps) {\r\n  const { user, loading } = useAuth();\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    if (!loading) {\r\n      if (!user) {\r\n        router.replace('/login');\r\n      } else if (role && user.role !== role) {\r\n        router.replace('/no-access');\r\n      }\r\n    }\r\n  }, [user, loading, role, router]);\r\n\r\n  if (loading || !user || (role && user.role !== role)) {\r\n    return <div className=\"flex items-center justify-center h-full text-lg\">Loading...</div>;\r\n  }\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AACA,gCAAgC;AAChC;AACA;AACA;AAJA;;;;;AAWe,SAAS,eAAe,EAAE,QAAQ,EAAE,IAAI,EAAuB;IAC5E,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAA,mJAAO;IACjC,MAAM,SAAS,IAAA,2JAAS;IAExB,IAAA,8NAAS,EAAC;QACR,IAAI,CAAC,SAAS;YACZ,IAAI,CAAC,MAAM;gBACT,OAAO,OAAO,CAAC;YACjB,OAAO,IAAI,QAAQ,KAAK,IAAI,KAAK,MAAM;gBACrC,OAAO,OAAO,CAAC;YACjB;QACF;IACF,GAAG;QAAC;QAAM;QAAS;QAAM;KAAO;IAEhC,IAAI,WAAW,CAAC,QAAS,QAAQ,KAAK,IAAI,KAAK,MAAO;QACpD,qBAAO,0PAAC;YAAI,WAAU;sBAAkD;;;;;;IAC1E;IACA,qBAAO;kBAAG;;AACZ"}},
    {"offset": {"line": 624, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Desktop/CRM/frontend/app/AppShell.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Sidebar from \"../components/ui/Sidebar\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport ProtectedRoute from \"../src/routes/ProtectedRoute\";\r\nimport { useState } from \"react\";\r\nimport { FiMenu } from \"react-icons/fi\";\r\nimport \"./responsive.css\";\r\n\r\nexport default function AppShell({ children }: { children: React.ReactNode }) {\r\n  const pathname = usePathname();\r\n  const isLogin = pathname === \"/login\";\r\n  const [sidebarOpen, setSidebarOpen] = useState(false);\r\n  if (isLogin) {\r\n    return <>{children}</>;\r\n  }\r\n  return (\r\n    <ProtectedRoute>\r\n      {/* Burger menu for mobile/tablet */}\r\n      <button className=\"burger-menu\" aria-label=\"Open sidebar\" onClick={() => setSidebarOpen(true)}>\r\n        <FiMenu size={28} color=\"#2563eb\" />\r\n      </button>\r\n      {/* Sidebar for desktop */}\r\n      <div className=\"sidebar-desktop\">\r\n        <Sidebar />\r\n      </div>\r\n      {/* Sidebar for mobile/tablet */}\r\n      <div className={`sidebar-mobile${sidebarOpen ? \" open\" : \"\"}`}>\r\n        <Sidebar onClose={() => setSidebarOpen(false)} />\r\n      </div>\r\n      {sidebarOpen && <div className=\"sidebar-backdrop\" onClick={() => setSidebarOpen(false)} />}\r\n      <main className=\"main-content\">{children}</main>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;;AASe,SAAS,SAAS,EAAE,QAAQ,EAAiC;IAC1E,MAAM,WAAW,IAAA,6JAAW;IAC5B,MAAM,UAAU,aAAa;IAC7B,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6NAAQ,EAAC;IAC/C,IAAI,SAAS;QACX,qBAAO;sBAAG;;IACZ;IACA,qBACE,0PAAC,uJAAc;;0BAEb,0PAAC;gBAAO,WAAU;gBAAc,cAAW;gBAAe,SAAS,IAAM,eAAe;0BACtF,cAAA,0PAAC,oKAAM;oBAAC,MAAM;oBAAI,OAAM;;;;;;;;;;;0BAG1B,0PAAC;gBAAI,WAAU;0BACb,cAAA,0PAAC,mJAAO;;;;;;;;;;0BAGV,0PAAC;gBAAI,WAAW,CAAC,cAAc,EAAE,cAAc,UAAU,IAAI;0BAC3D,cAAA,0PAAC,mJAAO;oBAAC,SAAS,IAAM,eAAe;;;;;;;;;;;YAExC,6BAAe,0PAAC;gBAAI,WAAU;gBAAmB,SAAS,IAAM,eAAe;;;;;;0BAChF,0PAAC;gBAAK,WAAU;0BAAgB;;;;;;;;;;;;AAGtC"}}]
}